<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w2.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml">    <head>        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>        <title>Google Maps API Example - Google North America Offices</title>    	<script src="http://maps.google.com/maps/api/js" type="text/javascript"></script>                <script type="text/javascript" src="https://rawgit.com/akbjat/GoogleMapRelatedData/master/markermanager.js"></script>        <script type="text/javascript" src="https://rawgit.com/akbjat/GoogleMapRelatedData/master/userData.js"></script>        <script type="text/javascript" src="https://rawgit.com/akbjat/GoogleMapRelatedData/master/geoDictionary.js"></script>                <script type="text/javascript">                                var map;            var markerManager;            //layer containing detais about states            var stateLayer = {            	"zoom": [0,5],            	"places" : []            };            //layer containing detais about cities            var cityLayer = {            	"zoom": [6,8],            	"places" : []            };            //layer containing details about zipcode            var zipcodeLayer = {            	"zoom": [9,15],            	"places" : []            	            };                        //	Region for classes that would be used to make layer object later for state, city and zipcode                        function StatePlace(userData, geoCode){            	this.state = userData.state,                this.count = 1,                this.lat = geoCode.lat,        		this["long"] = geoCode["long"]            }            function CityPlace(userData, geoCode){            	this.city = userData.city;            	//calling StatePlaceConstructor            	StatePlace.call(this, userData, geoCode);             }            CityPlace.prototype = Object.create(StatePlace.prototype);            CityPlace.prototype.constructor = CityPlace;            function ZipcodePlace(userData, geoCode){            	this.zipcode = userData.zipcode;            	CityPlace.call(this, userData, geoCode);            }        	ZipcodePlace.prototype = Object.create(CityPlace.prototype);        	ZipcodePlace.prototype.constructor = ZipcodePlace;        	// classes region end            window.onload = function(){            	initaiteGmap();            }            /*            	Initiate data to be plotted				This method will initiate/plot the map at the div "map"            */            function initaiteGmap() {                           initDataStore();                 var myOptions = {                zoom: 4,                center: new google.maps.LatLng(40.0443976, -97.9980449),                mapTypeId: google.maps.MapTypeId.ROADMAP              };              map = new google.maps.Map(document.getElementById('map'), myOptions);                        markerManager = new MarkerManager(map);                            google.maps.event.addListener(markerManager, 'loaded', function(){                setupMarkers();                              });                            }                        /*				updates stateLayer, cityLayer and zipcodeLayer depending on userDataToPlot and geocodeDictionary            */            function initDataStore(){             userDataToPlot.forEach(function(data, index){             	var geoCodeIndex = data.state + '|' + data.city + '|' + data.zipcode;             	var positionDetails = geocodeDictionary[geoCodeIndex];             	             	updateStateLayer(data, positionDetails);             	updateCityLayer(data, positionDetails);             	updateZipcodeLayer(data, positionDetails);             });	            }            function updateStateLayer(userData, geoCode){            	var stateAlreadyPresent = false;            	if(stateLayer.places.length > 0){                	for (var stateIndex=0;stateIndex < stateLayer.places.length; stateIndex++) {                		var place = stateLayer.places[stateIndex];                		if(place.state == userData.state){                			stateAlreadyPresent = true;                			place.count +=1;                			break;                		}                	}            	}                if(!stateAlreadyPresent){                	var newPlace = new StatePlace(userData, geoCode);                	stateLayer.places.push(newPlace);                }            }            function updateCityLayer(userData, geoCode){            	var cityAlreadyPresent = false;            	if(cityLayer.places.length > 0){                	for (var cityIndex=0; cityIndex < cityLayer.places.length; cityIndex++) {                		var place = cityLayer.places[cityIndex];                		if(place.city == userData.city){                			cityAlreadyPresent = true;                			place.count +=1;                			break;                		}                	}            	}                                if(!cityAlreadyPresent){                	var newPlace = new CityPlace(userData, geoCode);                	cityLayer.places.push(newPlace);                }            }            function updateZipcodeLayer(userData, geoCode){            	var zipcodeAlreadyPresent = false;            	if(zipcodeLayer.places.length > 0){                	for (var zipcodeIndex=0; zipcodeIndex < zipcodeLayer.places.length; zipcodeIndex++) {						var place = zipcodeLayer.places[zipcodeIndex];                		if(	place.zipcode == userData.zipcode){                			zipcodeAlreadyPresent = true;                			place.count +=1;                			break;                		}                	}            	}                                if(!zipcodeAlreadyPresent){					var newPlace = new ZipcodePlace(userData, geoCode);                	zipcodeLayer.places.push(newPlace);                }            }            // creates markers for all the three layers            function setupMarkers() {             				var stateMarkers = [];				stateLayer.places.forEach(function(place, index){					  var title = place.count + ' user from ' + place.state + ",US";                      var posn = new google.maps.LatLng(place["lat"], place["long"]);                      var stateMarker = createMarker(posn, title);                      stateMarkers.push(stateMarker);				});				markerManager.addMarkers(stateMarkers, stateLayer["zoom"][0], stateLayer["zoom"][1]);				var cityMarkers = [];				cityLayer.places.forEach(function(place, index){					  var title = place.count + ' user from ' + place.city + "," + place.state ;                      var posn = new google.maps.LatLng(place["lat"], place["long"]);                      var cityMarker = createMarker(posn, title);                      cityMarkers.push(cityMarker);				});				markerManager.addMarkers(cityMarkers, cityLayer["zoom"][0], cityLayer["zoom"][1]);				var zipcodeMarkers = [];				zipcodeLayer.places.forEach(function(place, index){					  var title = place.count + ' user from ' + place.zipcode + "," + place.city + "," + place.state ;                      var posn = new google.maps.LatLng(place["lat"], place["long"]);                      var zipcodeMarker = createMarker(posn, title);                      zipcodeMarkers.push(zipcodeMarker);				});				markerManager.addMarkers(zipcodeMarkers, zipcodeLayer["zoom"][0], zipcodeLayer["zoom"][1]);                                markerManager.refresh();                            }                        //returns a marker with infowindow set            function createMarker(posn, title) {              var markerOptions = {                position: posn,                title: title              };                                           var marker = new google.maps.Marker(markerOptions);                             // creates a new infoWindow with the given content             var infowindow = new google.maps.InfoWindow({      			content: "This marker contains " + title  			 });             // adding click event to show infoWindow  			 google.maps.event.addListener(marker, 'click', function() {    			infowindow.open(map,marker);  			 });             return marker;            }                                   //]]>        </script>    </head>    <body >        <br/>        <div id="map" style="width: 600px; height: 400px;"></div>            </body></html>